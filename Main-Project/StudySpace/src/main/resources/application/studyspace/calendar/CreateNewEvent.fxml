<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.collections.FXCollections?>
<?import java.lang.String?>

<StackPane xmlns="http://javafx.com/javafx/23.0.1"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="application.studyspace.controllers.calendar.CreateNewEventController"
           stylesheets="@../styles/forms/NewCalendarEvent.css"
           style="-fx-background-color: transparent; -fx-padding: 40;"
           prefWidth="600" prefHeight="700">

    <fx:define>
        <ToggleGroup fx:id="paginationGroup"/>
        <ToggleGroup fx:id="colorGroup"/>
    </fx:define>

    <VBox spacing="20"
          alignment="CENTER"
          style="-fx-background-color: white;
                 -fx-padding: 30;
                 -fx-background-radius: 15;
                 -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 12, 0, 0, 4);"
          minWidth="480">

        <!-- Top bar with close button -->
        <HBox alignment="CENTER_RIGHT" style="-fx-padding: 0 8 0 0;">
            <Button fx:id="closeBtn"
                    text="✕"
                    styleClass="nav-button"
                    onAction="#handleClickClosePopupButton"/>
        </HBox>

        <!-- Input form layout -->
        <HBox spacing="30" alignment="TOP_CENTER">
            <VBox spacing="20"
                  styleClass="card-box"
                  maxWidth="600">

                <Label text="Add a new Calendar Event"
                       style="-fx-font-size:22px; -fx-font-weight:bold;"/>

                <Label text="Title" styleClass="field-label"/>
                <TextField fx:id="EventTitleField"
                           promptText="e.g. Gym Session"
                           styleClass="styled-text-field"/>

                <Label text="Description" styleClass="field-label"/>
                <TextArea fx:id="descriptionArea"
                          promptText="e.g. Push/Pull/Legs"
                          prefRowCount="4"
                          styleClass="styled-text-area"/>

                <!-- Start Date -->
                <Label text="Start Date" styleClass="field-label"/>
                <DatePicker fx:id="startDatePicker"
                            promptText="Select start date"
                            styleClass="styled-date-picker"/>

                <!-- End Date -->
                <Label text="End Date" styleClass="field-label"/>
                <DatePicker fx:id="endDatePicker"
                            promptText="Select end date"
                            styleClass="styled-date-picker"/>

                <!-- Start Time -->
                <Label text="Start Time" styleClass="field-label"/>
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <TextField fx:id="hourFieldstart"
                               promptText="HH"
                               prefWidth="50"
                               style="-fx-alignment: center; -fx-background-radius: 6;"/>
                    <Label text=":" styleClass="time-separator"/>
                    <TextField fx:id="minuteFieldstart"
                               promptText="MM"
                               prefWidth="50"
                               style="-fx-alignment: center; -fx-background-radius: 6;"/>
                    <ComboBox fx:id="amPmDropdownstart"
                              prefWidth="100"
                              promptText="AM/PM"
                              styleClass="styled-combo">
                        <items>
                            <FXCollections fx:factory="observableArrayList">
                                <String fx:value="AM"/>
                                <String fx:value="PM"/>
                            </FXCollections>
                        </items>
                    </ComboBox>
                </HBox>

                <!-- End Time -->
                <Label text="End Time" styleClass="field-label"/>
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <TextField fx:id="hourFieldend"
                               promptText="HH"
                               prefWidth="50"
                               style="-fx-alignment: center; -fx-background-radius: 6;"
                               onMouseClicked="#showSmartSelectionDropdown"
                               onKeyReleased="#showSmartSelectionDropdown"/>
                    <Label text=":" styleClass="time-separator"/>
                    <TextField fx:id="minuteFieldend"
                               promptText="MM"
                               prefWidth="50"
                               style="-fx-alignment: center; -fx-background-radius: 6;"
                               onMouseClicked="#showSmartSelectionDropdown"
                               onKeyReleased="#showSmartSelectionDropdown"/>
                    <ComboBox fx:id="amPmDropdownend"
                              prefWidth="100"
                              promptText="AM/PM"
                              styleClass="styled-combo">
                        <items>
                            <FXCollections fx:factory="observableArrayList">
                                <String fx:value="AM"/>
                                <String fx:value="PM"/>
                            </FXCollections>
                        </items>
                    </ComboBox>
                </HBox>

                <Label text="Tags" styleClass="field-label"/>
                <FlowPane hgap="5" styleClass="tags-container" fx:id="tagsContainer">
                    <TextField fx:id="tagInputField" promptText="Type to search or add tag…"/>
                </FlowPane>

                <Label text="Color" styleClass="field-label"/>
                <HBox spacing="8">
                    <ToggleButton fx:id="colorRed"    toggleGroup="$colorGroup" styleClass="color-button"/>
                    <ToggleButton fx:id="colorBlue"   toggleGroup="$colorGroup" styleClass="color-button"/>
                    <ToggleButton fx:id="colorGreen"  toggleGroup="$colorGroup" styleClass="color-button"/>
                    <ToggleButton fx:id="colorYellow" toggleGroup="$colorGroup" styleClass="color-button"/>
                    <ToggleButton fx:id="colorPurple" toggleGroup="$colorGroup" styleClass="color-button"/>
                </HBox>
            </VBox>
        </HBox>

        <!-- Bottom pager + Finish -->
        <HBox spacing="12" alignment="CENTER">
            <Region HBox.hgrow="ALWAYS"/>
            <Button text="Create"
                    fx:id="CreateBtn"
                    styleClass="page-button-selected"
                    onAction="#handleSave"/>
        </HBox>
    </VBox>

    <!-- Autocomplete suggestions -->
    <ListView fx:id="suggestionsListView"
              styleClass="autocomplete-list"
              visible="false"
              maxWidth="200"
              maxHeight="150"/>
</StackPane>
