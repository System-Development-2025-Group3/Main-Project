<?xml version="1.0" encoding="UTF-8"?>
<?import com.calendarfx.view.CalendarView?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import org.kordamp.ikonli.javafx.FontIcon?>
<?import javafx.scene.paint.RadialGradient?>
<?import javafx.scene.paint.Stop?>
<?import javafx.scene.paint.Color?>

<VBox xmlns="http://javafx.com/javafx/17.0.12"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="application.studyspace.controllers.landingpage.LandingpageController"
      styleClass="root"
      stylesheets="@../styles/LoginandRegister/LoginandRegisterStylesheet.css,@../styles/LandingPage/LandingPageStylesheet.css"
      prefWidth="1200" prefHeight="800"
      spacing="0">

    <!-- HEADER CARD -->
    <HBox styleClass="header-card"
          alignment="CENTER_LEFT">
        <Label text="âšœ Planify Calendar" styleClass="header-title"/>
    </HBox>

    <!-- MAIN CONTENT: Sidebar + Calendar cards -->
    <HBox spacing="20"
          VBox.vgrow="ALWAYS"
          style="-fx-padding: 16 16 16 16;">
        <!-- SIDEBAR CARD -->
        <VBox styleClass="login-card"
              spacing="20"
              prefWidth="240"
              VBox.vgrow="ALWAYS">
            <Label text="Study Planner" styleClass="login-title"/>
            <ToggleButton text="ðŸ“…  Calendar"
                          styleClass="sidebar-button"
                          toggleGroup="$navGroup"
                          selected="true"
                          onAction="#handleSidebarCalendar"/>
            <ToggleButton text="ðŸ“Š  Dashboard"
                          styleClass="sidebar-button"
                          toggleGroup="$navGroup"
                          onAction="#handleSidebarDashboard"/>
            <ToggleButton text="âš™  Settings"
                          styleClass="sidebar-button"
                          toggleGroup="$navGroup"
                          onAction="#handleSidebarSettings"/>
            <Region VBox.vgrow="ALWAYS"/>
            <Button fx:id="exitButton"
                    styleClass="sidebar-logout"
                    onAction="#handleExit">
                <graphic>
                    <FontIcon iconLiteral="fas-sign-out-alt" iconSize="16" iconColor="black"/>
                </graphic>
                <Label text="Logout" styleClass="logout-label"/>
            </Button>
        </VBox>

        <!-- CALENDAR CARD -->
        <VBox styleClass="login-card"
              VBox.vgrow="ALWAYS">
            <CalendarView fx:id="calendarView"
                          VBox.vgrow="ALWAYS"
                          selectionMode="SINGLE"
                          showAddCalendarButton="false"
                          showPageSwitcher="false"
                          showPrintButton="false"
                          showSearchField="false"
                          showSourceTrayButton="false"
                          showToday="false"
                          showToolBar="false"
                          stylesheets="@../styles/calendar/calendarfx-overrides.css">
                <availabilityFill>
                    <RadialGradient centerX="0.5" centerY="0.5" radius="0.5">
                        <stops>
                            <Stop offset="0.0">
                                <color>
                                    <Color red="0.153" green="0.107" blue="0.565" opacity="0.1"/>
                                </color>
                            </Stop>
                            <Stop offset="1.0">
                                <color>
                                    <Color red="1.0" green="1.0" blue="1.0" opacity="1.0"/>
                                </color>
                            </Stop>
                        </stops>
                    </RadialGradient>
                </availabilityFill>
            </CalendarView>
        </VBox>
    </HBox>

    <!-- FLOATING ADD BUTTON -->
    <StackPane pickOnBounds="false" VBox.vgrow="NEVER">
        <Button fx:id="addEventButton"
                styleClass="floating-add-button"
                onAction="#openAddOverlay"
                StackPane.alignment="CENTER">
            <graphic>
                <FontIcon iconLiteral="fas-plus" iconSize="18" iconColor="white"/>
            </graphic>
        </Button>
    </StackPane>

    <!-- ================= Overlay Pane ================= -->
    <VBox fx:id="addOverlayPane"
          visible="false" managed="false"
          style="-fx-background-color: rgba(0,0,0,0.5);"
          VBox.vgrow="ALWAYS">
        <VBox spacing="16" alignment="TOP_CENTER"
              style="-fx-background-color: white;
                     -fx-background-radius: 12;
                     -fx-padding: 24;
                     -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 12, 0, 0, 4);"
              maxWidth="520">
            <!-- Exam vs Blocker toggles -->
            <HBox spacing="8">
                <ToggleButton fx:id="examToggle" text="Exam"/>
                <ToggleButton fx:id="blockerToggle" text="Blocker"/>
            </HBox>
            <!-- Forms -->
            <StackPane prefWidth="500" prefHeight="400">
                <VBox fx:id="examForm" spacing="12">
                    <Label text="Exam Name"/>
                    <TextField fx:id="examNameField" promptText="e.g. Calculus"/>
                    <Label text="Description"/>
                    <TextArea fx:id="descriptionArea" promptText="Covers chapters 1-5" prefRowCount="3"/>
                    <Label text="Start Date"/>
                    <DatePicker fx:id="exStartDate"/>
                    <Label text="End Date"/>
                    <DatePicker fx:id="exEndDate"/>
                    <Label text="Estimated Study Minutes"/>
                    <TextField fx:id="estimatedMinutesField" promptText="e.g. 120"/>
                </VBox>
                <VBox fx:id="blockerForm" spacing="12">
                    <Label text="Event Title"/>
                    <TextField fx:id="evtTitleField" promptText="e.g. Team Meeting"/>
                    <Label text="Location"/>
                    <TextField fx:id="evtLocationField" promptText="e.g. Room 101"/>
                    <Label text="Start"/>
                    <HBox spacing="6">
                        <DatePicker fx:id="evtStartDate"/>
                        <Spinner fx:id="evtStartTime" editable="true"/>
                    </HBox>
                    <Label text="End"/>
                    <HBox spacing="6">
                        <DatePicker fx:id="evtEndDate"/>
                        <Spinner fx:id="evtEndTime" editable="true"/>
                    </HBox>
                    <CheckBox fx:id="evtAllDay" text="All day"/>
                </VBox>
            </StackPane>
            <!-- Cancel/Save buttons -->
            <HBox spacing="12" alignment="CENTER_RIGHT">
                <Button text="Cancel" onAction="#closeAddOverlay"/>
                <Button text="Save"   onAction="#saveNewItem"/>
            </HBox>
        </VBox>
    </VBox>

    <!-- Define navigation group -->
    <fx:define>
        <ToggleGroup fx:id="navGroup"/>
    </fx:define>

</VBox>